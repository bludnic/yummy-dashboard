{"version":3,"sources":["webpack:///webpack/bootstrap e2dc60340ea167594188","webpack:///external \"mongoose\"","webpack:///./server/config/passport.js","webpack:///external \"koa-router\"","webpack:///./server/middlewares/roles.js","webpack:///./server/errors/AppError.js","webpack:///./server/models/util/order.js","webpack:///./~/babel-runtime/regenerator/index.js","webpack:///external \"fs\"","webpack:///external \"dotenv/config\"","webpack:///external \"koa-passport\"","webpack:///external \"path\"","webpack:///./server/controllers/profile.js","webpack:///./server/models/Category.js","webpack:///./server/models/MenuItem.js","webpack:///./server/models/User.js","webpack:///./server/routes/validation/profile.js","webpack:///./server/services/order.js","webpack:///./server/services/user.js","webpack:///external \"koa-joi-validate\"","webpack:///external \"passport\"","webpack:///external \"passport-jwt\"","webpack:///./nuxt.config.js","webpack:///./server/db.js","webpack:///./server/routes/index.js","webpack:///external \"http\"","webpack:///external \"https\"","webpack:///external \"koa\"","webpack:///external \"koa-body\"","webpack:///external \"koa-force-ssl\"","webpack:///external \"koa-mount\"","webpack:///external \"koa-static\"","webpack:///external \"koa2-cors\"","webpack:///external \"nuxt\"","webpack:///./server/config/facebook.js","webpack:///./server/controllers/category.js","webpack:///./server/controllers/coupon.js","webpack:///./server/controllers/menuItem.js","webpack:///./server/controllers/options.js","webpack:///./server/controllers/order.js","webpack:///./server/controllers/storage.js","webpack:///./server/controllers/upload.js","webpack:///./server/controllers/user.js","webpack:///./server/dummy/index.js","webpack:///./server/models/Coupon.js","webpack:///./server/models/Options.js","webpack:///./server/models/Order.js","webpack:///./server/models/methods/category.js","webpack:///./server/models/methods/coupon.js","webpack:///./server/models/methods/menuItem.js","webpack:///./server/models/methods/options.js","webpack:///./server/models/methods/order.js","webpack:///./server/models/methods/user.js","webpack:///./server/models/types/MenuItemPrice.js","webpack:///./server/models/types/Option.js","webpack:///./server/models/types/OptionGroup.js","webpack:///./server/models/types/OrderItem.js","webpack:///./server/models/types/OrderOption.js","webpack:///./server/models/types/OrderOptionGroup.js","webpack:///./server/models/types/UserShipAddress.js","webpack:///./server/models/util/options.js","webpack:///./server/models/util/transformID.js","webpack:///./server/models/validate/category.js","webpack:///./server/models/validate/coupon.js","webpack:///./server/models/validate/menuItem.js","webpack:///./server/models/validate/options.js","webpack:///./server/models/validate/order.js","webpack:///./server/routes/auth.js","webpack:///./server/routes/category.js","webpack:///./server/routes/coupon.js","webpack:///./server/routes/dummy.js","webpack:///./server/routes/menu.js","webpack:///./server/routes/options.js","webpack:///./server/routes/order.js","webpack:///./server/routes/profile.js","webpack:///./server/routes/storage.js","webpack:///./server/routes/upload.js","webpack:///./server/routes/user.js","webpack:///./server/services/category.js","webpack:///./server/services/coupon.js","webpack:///./server/services/menuItem.js","webpack:///./server/services/options.js","webpack:///./server/services/profile.js","webpack:///./server/services/storage.js","webpack:///./server/services/upload.js","webpack:///external \"aws-sdk\"","webpack:///external \"crypto\"","webpack:///external \"currency-codes\"","webpack:///external \"joi\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"koa-roles\"","webpack:///external \"passport-facebook\"","webpack:///external \"passport-local\"","webpack:///external \"regenerator-runtime\"","webpack:///external \"uuid\"","webpack:///./server/index.js"],"names":["FacebookStrategy","require","Strategy","JwtStrategy","ExtractJwt","jwtOptions","jwtFromRequest","fromAuthHeaderAsBearerToken","secretOrKey","passport","use","usernameField","passwordField","session","email","password","done","UserService","authenticate","then","user","catch","err","payload","getProfile","id","profile","clientID","facebook","clientId","clientSecret","callbackURL","callbackUrl","profileFields","accessToken","refreshToken","ctx","next","_id","token","jwt","sign","body","displayName","authenticateFacebook","failureRedirect","authFacebook","authorize","generateJWT","roles","failureHandler","action","console","log","OrderService","isOwner","params","role","AppError","message","status","name","constructor","Error","captureStackTrace","getMenuItemPrice","menuItem","size","price","Array","isArray","prices","length","forEach","priceObj","getOptionPrice","groupId","optionId","optionGroups","optionGroup","toString","options","option","_getOptionPriceBySizeName","getTotalPrice","lineItems","total","extraTotal","lineItem","group","quantity","getOptionGroupById","optionGroupId","groupRef","getOptionById","optionRef","getDiscountPrice","coupon","discountPrice","dicountType","discountType","discount","optionPrices","itemPrice","priceIndex","index","registerUser","request","ProfileService","updateProfile","Schema","mongoose","ObjectId","CategorySchema","type","String","required","slug","versionKey","plugin","model","MenuItemSchema","description","weight","Number","featuredImageKey","images","isFeatured","Boolean","pizzaGroups","category","ref","timestamps","toJSON","virtuals","virtual","get","AWS_BUCKET","process","env","AWS_REGION","defaultShipAddress","firstName","lastName","street","streetNumber","entrance","level","apartment","entranceCode","UserSchema","unique","phone","passwordHash","salt","shipAddress","default","provider","transform","update","Joi","string","allow","create","regex","login","getOrders","Order","createOrder","save","getOrder","order","updateOrder","removeOrder","findByIdAndRemove","exec","orderId","userId","findOne","getUsers","page","perPage","User","find","createUser","getUser","findById","res","updateUser","findByIdAndUpdate","deleteUser","emails","value","split","findOneAndUpdate","new","checkPassword","select","module","exports","head","title","meta","charset","content","hid","link","rel","href","css","loading","color","build","extend","config","isClient","rules","push","enforce","test","loader","exclude","plugins","modules","baseURL","BASE_URL","apiURL","Promise","set","connect","MONGODB_URI","db","connection","on","error","bind","app","prefix","menu","routes","auth","upload","storage","dummy","getCategories","CategoryService","categories","createCategory","getCategory","updateCategory","removeCategory","getCoupons","CouponService","coupons","createCoupon","getCoupon","updateCoupon","removeCoupon","getMenuItems","query","MenuItemService","menuItems","createMenuItem","getMenuItem","updateMenuItem","removeMenuItem","getOptions","OptionsService","saveOptions","orders","uploadImage","file","files","image","fileName","uuid","StorageService","uploadFeaturedImage","newFileName","Date","now","UploadService","users","pizzas","featuredImage","multiselect","soups","CouponSchema","enum","OptionSchema","deliveryPrice","freeShippingFrom","deliveryTime","storeAddress1","storeAddress2","storeCity","storeCountry","storePostcode","currency","currencyPosition","currencyThSeperator","currencyDecSeperator","currencyNumDec","paymentStripeKey","paymentPaypalKey","OrderSchema","items","source","methods","toObject","subtotal","lineItemTotal","schema","statics","sort","createdAt","populate","updateOptions","upsert","setDefaultsOnInsert","runValidators","updatedAt","path","code","$set","_plainPassword","crypto","randomBytes","pbkdf2Sync","undefined","MenuItemPriceSchema","OptionGroupSchema","min","max","OrderItemSchema","groupTotalPrice","optionsTotalPrice","lineItemPrice","OrderOptionSchema","parent","unitPrice","OrderOptionGroupSchema","optionTotalPrice","UserShipAddressSchema","currencies","cc","codes","transformID","doc","ret","router","post","validate","validations","scope","can","put","delete","map","item","result","throw","Category","Coupon","MenuItem","Options","selectedFields","AWS","accessKeyId","AWS_ACCESS_KEY","secretAccessKey","AWS_SECRET_KEY","region","s3","S3","resolve","reject","fs","readFile","data","Key","Body","ContentType","Bucket","location","Location","key","filename","newFilePath","join","__dirname","writeFile","unlink","host","HOST","port","PORT","emit","cors","origin","bodyParser","multipart","mount","serve","initialize","middleware","Routes","dev","nuxt","builder","render","req","promise","once","listen","start","server"],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,I;;;;;;;;ACxLe,SAASC,WAAT,CAAsBC,GAAtB,EAA2BC,GAA3B,EAAgC;AAC7CA,MAAIpU,EAAJ,GAASoU,IAAIvT,GAAb;AACA,SAAOuT,IAAIvT,GAAX;AACD,C;;;;;;;ACHD,4CAAe,UAACkR,MAAD,EAASvO,OAAT,EAAqB,CAEnC,CAFD,C;;;;;;;ACAA,4CAAe,UAACuO,MAAD,EAASvO,OAAT,EAAqB,CAEnC,CAFD,C;;;;;;;ACAA,4CAAe,UAACuO,MAAD,EAASvO,OAAT,EAAqB,CAEnC,CAFD,C;;;;;;;ACAA,4CAAe,UAACuO,MAAD,EAASvO,OAAT,EAAqB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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 94);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e2dc60340ea167594188","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","import passport from 'koa-passport'\nimport LocalStrategy from 'passport-local'\nimport jwt from 'jsonwebtoken'\n\nimport UserService from './../services/user'\nimport facebook from './facebook'\nimport AppError from './../errors/AppError'\n\nconst FacebookStrategy = require('passport-facebook').Strategy\nconst JwtStrategy = require('passport-jwt').Strategy\nconst ExtractJwt = require('passport-jwt').ExtractJwt\nconst jwtOptions = {\n  jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n  secretOrKey: 'si-pula-ne'\n}\n\n\n/*\n * Local Strategy\n */\npassport.use(new LocalStrategy({\n  usernameField: 'email',\n  passwordField: 'password',\n  session: false\n}, (email, password, done) => {\n\n  UserService.authenticate(email, password)\n  .then(user => done(null, user))\n  .catch(err => done(err, false))\n\n}))\n\n/*\n * JWT Strategy\n */\npassport.use(new JwtStrategy(jwtOptions, (payload, done) => {\n\n  UserService.getProfile(payload.id)\n  .then(profile => done(null, profile))\n  .catch(err => done(err, false))\n\n}))\n\n/**\n * Facebook Strategy\n * https://github.com/wahyudibo/koa-passport-facebook-example\n */\npassport.use(new FacebookStrategy({\n  clientID: facebook.clientId,\n  clientSecret: facebook.clientSecret,\n  callbackURL: facebook.callbackUrl,\n  profileFields: facebook.profileFields,\n}, (accessToken, refreshToken, profile, done) => {\n  return done(null, profile)\n}))\n\n\n/*\n * Authenticate middleware Helper.\n */\nexport function authenticate (ctx, next) {\n  return (ctx, next) => {\n\n    return passport.authenticate('local', (err, user) => {\n      if (err) throw err\n\n      const payload = {\n        id: user._id,\n        email: user.email\n      }\n      const token = jwt.sign(payload, jwtOptions.secretOrKey)\n\n      ctx.body = { user: user.displayName, token: token }\n    })(ctx, next)\n\n  }\n}\n\n/**\n * Authenticate facebook middleware helper\n */\nexport function authenticateFacebook (ctx, next) {\n  return (ctx, next) => {\n\n    return passport.authenticate('facebook', {\n      session: false,\n      failureRedirect : '/api' // @TODO change failure redirect\n    }, (err, user) => {\n      if (err) throw err\n\n      return UserService.authFacebook(user) // register or update facebook profile\n      .then(profile => {\n\n        const payload = {\n          id: profile._id, // facebook ID or bd ID?\n          email: profile.email\n        }\n        const token = jwt.sign(payload, jwtOptions.secretOrKey)\n\n        ctx.body = { token: token }\n\n      })\n      .catch((err) => { throw err })\n\n    })(ctx, next)\n\n  }\n}\n\n/*\n * Authorization middleware Helper.\n */\nexport function authorize () {\n  return (ctx, next) => {\n    return passport.authenticate('jwt', (err, user) => {\n\n      if (err) throw err\n      if (!user) throw new AppError('Unauthorized', 401)\n\n      ctx.user = user\n\n      return next()\n    })(ctx, next)\n  }\n}\n\n/**\n * Generate JWT token\n */\nexport function generateJWT (user) {\n  const payload = {\n    id: user.id,\n    email: user.email\n  }\n  const token = jwt.sign(payload, jwtOptions.secretOrKey)\n\n  return token\n}\n\n\n// WEBPACK FOOTER //\n// ./server/config/passport.js","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 2\n// module chunks = 0","import Roles from 'koa-roles'\nimport AppError from './../errors/AppError'\nimport OrderService from './../services/order'\n\nconst roles = new Roles({\n  async failureHandler(ctx, action) {\n    throw new AppError(`Access Denied - You don't have permission to: ${action}`, 403)\n  }\n})\n\n// anonymous users can only access the home page\n// returning false stops any more rules from being\n// considered\nroles.use(async (ctx, action) => {\n  console.log('access public middleware', ctx.user);\n  return ctx.user || action === 'access public routes'\n})\n\n// Can access order :id\nroles.use('access order', async (ctx) => {\n  const isOwner = await OrderService.isOwner(ctx.params.id, ctx.user.id)\n  if (isOwner) return true\n})\n\n// Can access admin role\nroles.use('access admin', (ctx) => {\n  if (ctx.user.role === 'admin') return true\n})\n\n\n// moderator users can access private page, but\n// they might not be the only ones so we don't return\n// false if the user isn't a moderator\nroles.use('access private page', ctx => {\n  if (ctx.user.role === 'moderator') {\n    return true;\n  }\n})\n\n//admin users can access all pages\nroles.use((ctx, action) => {\n  if (ctx.user.role === 'admin') {\n    return true;\n  }\n})\n\nexport default roles\n\n\n// WEBPACK FOOTER //\n// ./server/middlewares/roles.js","// https://gist.github.com/slavafomin/b164e3e710a6fc9352c934b9073e7216\nexport default class AppError extends Error {\n  constructor(message, status) {\n\n    // Calling parent constructor of base Error class.\n    super(message)\n\n    // Saving class name in the property of our custom error as a shortcut.\n    this.name = this.constructor.name\n\n    // Capturing stack trace, excluding constructor call from it.\n    Error.captureStackTrace(this, this.constructor)\n    \n    // You can use any additional properties you want.\n    // I'm going to use preferred HTTP status for this error types.\n    // `500` is the default value if not specified.\n    this.status = status || 500\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/errors/AppError.js","/*\n * Get MenuItem price by size name\n */\nexport const getMenuItemPrice = (menuItem, size) => {\n  let price = 0\n\n  if (!menuItem) return 0;\n  if (!Array.isArray(menuItem.prices)) return 0;\n\n  // Return price if has only one Size\n  if (menuItem.prices.length === 1) return menuItem.prices[0].price\n\n  menuItem.prices.forEach(priceObj => {\n    if (priceObj.name === size) {\n      price = priceObj.price\n    }\n  })\n  return price\n}\n\n/*\n * Get Option price of MenuItem\n */\nexport const getOptionPrice = (menuItem, groupId, optionId, size) => {\n  let price = 0\n\n  if (!menuItem) return 0;\n  if (!Array.isArray(menuItem.optionGroups)) return 0;\n\n  menuItem.optionGroups.forEach(optionGroup => {\n    if (optionGroup._id.toString() !== groupId) return;\n\n    optionGroup.options.forEach(option => {\n      if (option._id.toString() !== optionId) return;\n\n      // Get price for specific size\n      if (size) {\n        price = _getOptionPriceBySizeName(menuItem, option.prices, size)\n      } else {\n        price = option.prices[0]\n      }\n    })\n  })\n  return price\n}\n\n/*\n * Get LineItems total price\n */\nexport const getTotalPrice = (lineItems) => {\n  let total = 0\n\n  lineItems.forEach(lineItem => {\n    let extraTotal = 0\n\n    if (!Array.isArray(lineItem.optionGroups)) return 0;\n    \n    lineItem.optionGroups.forEach(group => {\n      group.options.forEach(option => {\n        const price = getOptionPrice(lineItem.menuItem, group.id, option.id, lineItem.size) * option.quantity\n        extraTotal += price\n      })\n    })\n\n    total += ( extraTotal + getMenuItemPrice(lineItem.menuItem, lineItem.size) ) * lineItem.quantity\n  })\n\n  return total\n}\n\n/*\n * Get OptionGroup ref by optionGroupId\n */\nexport const getOptionGroupById = (menuItem, optionGroupId) => {\n  let groupRef = null\n  \n  if (!Array.isArray(menuItem.optionGroups)) return null;\n  \n  menuItem.optionGroups.forEach(optionGroup => {\n    if (optionGroup._id.toString() === optionGroupId) {\n      groupRef = optionGroup\n    }\n  })\n\n  return groupRef\n}\n\n/*\n * Get Option ref by optionId\n */\nexport const getOptionById = (menuItem, optionGroupId, optionId, size = '') => {\n  let optionRef = null\n\n  if (!Array.isArray(menuItem.optionGroups)) return null;\n\n  menuItem.optionGroups.forEach(optionGroup => {\n\n    // Each OptionGroups\n    if (optionGroup._id.toString() === optionGroupId) {\n\n      // Each Options\n      optionGroup.options.forEach(option => {\n        if (option._id.toString() === optionId) {\n          const price = _getOptionPriceBySizeName(menuItem, option.prices, size)\n          \n          optionRef = option\n          optionRef.price = price\n          delete optionRef.prices\n        }\n      })\n\n    }\n\n  })\n\n  return optionRef\n}\n\n/**\n * Get discount price by Total and Coupon\n */\nexport const getDiscountPrice = (total, coupon) => {\n  let discountPrice = 0\n  const dicountType = coupon && coupon.discountType\n\n  if (dicountType=== 'number') {\n    discountPrice = total - coupon.discount\n  } else if (dicountType === 'percent') {\n    discountPrice = total - (total / (100 / coupon.discount ) )\n  } else {\n    discountPrice = total\n  }\n  return discountPrice\n}\n\n/*\n * Get option price by MenuItem size name\n */\nconst _getOptionPriceBySizeName = (menuItem, optionPrices, size) => {\n  let itemPrice = 0\n  let priceIndex = 0\n\n  menuItem.prices.forEach((price, index) => {\n    if (price.name === size) {\n      priceIndex = index\n    }\n  })\n\n  return optionPrices[priceIndex] || optionPrices[0]\n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/util/order.js","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/regenerator/index.js\n// module id = 6\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"dotenv/config\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv/config\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"koa-passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-passport\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 10\n// module chunks = 0","import ProfileService from './../services/profile'\n\nexport function registerUser (ctx) {\n  const user = ctx.request.body\n\n  // return ctx.body = user\n\n  return ProfileService.registerUser(user)\n  .then(user => ctx.body = user)\n}\n\nexport function getProfile (ctx) {\n  const id = ctx.user.id\n\n  return ProfileService.getProfile(id)\n  .then(user => ctx.body = user)\n}\n\nexport function updateProfile (ctx) {\n  const id = ctx.user.id\n  const body = ctx.request.body\n\n  return ProfileService.updateProfile(id, body)\n  .then(user => ctx.body = user)\n}\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/profile.js","import mongoose from 'mongoose'\n\nimport schemaMethods from './methods/category'\nimport schemaValidate from './validate/category'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst CategorySchema = new Schema({\n  name: { type: String, required: true },\n  slug: { type: String }\n}, { versionKey: false })\n\n/*\n * Plugins\n */\nCategorySchema.plugin(schemaMethods) // schema methods\nCategorySchema.plugin(schemaValidate) // schema validation\n\nexport default mongoose.model('Category', CategorySchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/Category.js","import mongoose from 'mongoose'\n\nimport MenuItemPrice from './types/MenuItemPrice'\nimport OptionGroup from './types/OptionGroup'\nimport schemaMethods from './methods/menuItem'\nimport schemaValidate from './validate/menuItem'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst MenuItemSchema = new Schema({\n  name: { type: String, required: true },\n  description: { type: String, required: true },\n  prices: [MenuItemPrice],\n  weight: Number, // in gramms\n\n  // featuredImage: String,\n  featuredImageKey: String,\n  images: [String],\n  isFeatured: Boolean,\n\n  optionGroups: [OptionGroup],\n  pizzaGroups: [],\n\n  category: { type: ObjectId, ref: 'Category' }\n}, { versionKey: false, timestamps: true, toJSON: { virtuals: true } })\n\n/**\n * Virtuals\n */\nMenuItemSchema.virtual('featuredImageURL').get(function () {\n  const AWS_BUCKET = process.env.AWS_BUCKET\n  const AWS_REGION = process.env.AWS_REGION\n  if (this.featuredImageKey) {\n    return `http://${AWS_BUCKET}.s3-website.${AWS_REGION}.amazonaws.com/${this.featuredImageKey}`\n  }\n  return null\n})\n\nMenuItemSchema.virtual('featuredImageSquare').get(function () {\n  const AWS_BUCKET = process.env.AWS_BUCKET\n  const AWS_REGION = process.env.AWS_REGION\n  const size = '75x75'\n  if (this.featuredImageKey) {\n    return `http://${AWS_BUCKET}.s3-website.${AWS_REGION}.amazonaws.com/${size}/${this.featuredImageKey}`\n  }\n  return null\n})\n\n/*\n * Plugins\n */\nMenuItemSchema.plugin(schemaMethods) // schema methods\nMenuItemSchema.plugin(schemaValidate) // schema validation\n\nexport default mongoose.model('MenuItem', MenuItemSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/MenuItem.js","import mongoose from 'mongoose'\n\nimport transformID from './util/transformID'\nimport UserShipAddress from './types/UserShipAddress'\nimport schemaMethods from './methods/user'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst defaultShipAddress = {\n  firstName: '',\n  lastName: '',\n  street: '',\n  streetNumber: '',\n  entrance: '',\n  level: '',\n  apartment: '',\n  entranceCode: ''\n}\n\nconst UserSchema = new Schema({\n  firstName: String,\n  lastName: String,\n  email: { type: String, required: true, unique: true },\n  phone: { type: String },\n\n  passwordHash: String,\n  salt: String,\n  \n  shipAddress: { type: UserShipAddress, default: defaultShipAddress },\n\n  provider: String,\n  role: { type: String, default: 'user' }\n}, { versionKey: false, toJSON: { transform: transformID }})\n\n/*\n * Plugins\n */\nUserSchema.plugin(schemaMethods) // schema methods\n\nexport default mongoose.model('User', UserSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/User.js","import Joi from 'joi'\n\nexport default {\n  update: {\n    body: {\n      firstName: Joi.string().allow(''),\n      lastName: Joi.string().allow(''),\n      phone: Joi.string().allow(''),\n      shipAddress: {\n        street: Joi.string().allow(''),\n        streetNumber: Joi.string().allow(''),\n        entrance: Joi.string().allow(''),\n        level: Joi.string().allow(''),\n        apartment: Joi.string().allow(''),\n        entranceCode: Joi.string().allow('')\n      }\n    }\n  },\n  create: {\n    body: {\n      firstName: Joi.string().allow(''),\n      lastName: Joi.string().allow(''),\n      phone: Joi.string().allow(''),\n      email: Joi.string().email().required(),\n      password: Joi.string().regex(/^[a-zA-Z0-9]{3,30}$/).required()\n    }\n  },\n  login: {\n    body: {\n      email: Joi.string().email().required(),\n      password: Joi.string().regex(/^[a-zA-Z0-9]{3,30}$/).required()\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/routes/validation/profile.js","import Order from './../models/Order'\nimport AppError from './../errors/AppError'\n\nexport default {\n  getOrders ({ user }) {\n    // { order, orderby, page, per_page }\n    const params = {}\n    if (user) params.user = user\n\n    return Order.getOrders(params)\n  },\n\n  createOrder (payload) {\n    return new Order(payload).save()\n  },\n\n  getOrder (id) {\n    return Order.getOrder(id)\n    .then(order => {\n      if (!order) throw new AppError('Item not found', 404)\n      return order\n    })\n  },\n\n  updateOrder (id, payload) {\n    return Order.updateOrder(id, payload)\n    .then(order => {\n      if (!order) throw new AppError('Item not found', 404)\n      return order\n    })\n  },\n\n  removeOrder (id) {\n    return Order.findByIdAndRemove(id).exec()\n    .then(order => {\n      if (!order) throw new AppError('Item not found', 404)\n      return order\n    })\n  },\n\n  isOwner (orderId, userId) {\n    return Order.findOne({ _id: orderId, user: userId }).exec()\n    .then(order => {\n      if (order) return true\n      return false\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/services/order.js","import User from './../models/User'\nimport AppError from './../errors/AppError'\n\nexport default {\n  getUsers ({ page, perPage }) {\n    return User.find({}).exec()\n  },\n  createUser (payload) {\n    return User.create(payload)\n  },\n  getUser (id) {\n    console.log('getUser', id)\n    return User.findById(id).exec()\n    .then(res => {\n      console.log('user', res);\n      if (!res) throw new AppError('Item not found', 404)\n      return res\n    })\n  },\n  updateUser (id, payload) {\n    return User.findByIdAndUpdate(id, payload).exec()\n    .then(res => {\n      if (!res) throw new AppError('Item not found', 404)\n      return res\n    })\n  },\n  deleteUser (id) {\n    return User.findByIdAndRemove(id)\n    .then(res => {\n      if (!res) throw new AppError('Item not found', 404)\n      return res\n    })\n  },\n\n\n  authFacebook (profile) {\n    const email = profile.emails[0].value\n    const displayName = profile.displayName.split(' ')\n    const firstName = displayName[0]\n    const lastName = displayName[1]\n\n    return User.findOne({ email }).exec()\n    .then(user => {\n      if (user) {\n        // If user exists, update profile\n        return User.findOneAndUpdate({ email }, { firstName, lastName }, { new: true }).exec()\n      } else {\n        // If user with this email not found, then register\n        return User.create({ email, firstName, lastName })\n      }\n    })\n  },\n  \n  authenticate (email, password) {\n    return User.findOne({ email }).exec()\n    .then(user => {\n      if (user && user.checkPassword(password)) {\n        return user\n      } else {\n        throw new AppError('User not found or incorect password', 400)\n      }\n    })\n  },\n  getProfile (id) {\n    return User.findById(id).select(['_id', 'email', 'role']).exec()\n    .then(user => {\n      if (user) {\n        return {\n          id: user._id,\n          email: user.email,\n          role: user.role\n        }\n      } else {\n        throw new AppError('This user was disabled by admin', 400)\n      }\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/services/user.js","module.exports = require(\"koa-joi-validate\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-joi-validate\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"passport-jwt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-jwt\"\n// module id = 20\n// module chunks = 0","require('dotenv/config')\n\nmodule.exports = {\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: 'Yummy dashboard',\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' },\n      { rel: 'stylesheet', href: 'https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons' }\n    ]\n  },\n  /*\n  ** Global CSS\n  */\n  css: [\n    '~/assets/style/app.styl',\n    'mdi/css/materialdesignicons.min.css'\n  ],\n  /*\n  ** Customize the progress-bar color\n  */\n  loading: { color: '#3B8070' },\n  /*\n   ** Build configuration\n   */\n  build: {\n    /*\n     ** Run ESLINT on save\n     */\n    extend (config, ctx) {\n      if (ctx.isClient) {\n        config.module.rules.push({\n          enforce: 'pre',\n          test: /\\.(js|vue)$/,\n          loader: 'eslint-loader',\n          exclude: /(node_modules)/\n        })\n      }\n    }\n  },\n  plugins: ['~/plugins/vuetify.js', '~/plugins/axios.js'],\n  /*\n   * Nuxt modules\n   */\n  modules: ['@nuxtjs/axios'],\n  /*\n   * Env\n   */\n  env: {\n    baseURL: process.env.BASE_URL,\n    apiURL: process.env.BASE_URL + '/api'\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","import mongoose from 'mongoose'\n\nmongoose.Promise = Promise\nmongoose.set('debug', true)\n\nmongoose.connect(process.env.MONGODB_URI)\nconsole.log('DB', process.env.MONGODB_URI)\n\nconst db = mongoose.connection\ndb.on('error', console.error.bind(console, 'connection error:'))\n\nexport default db\n\n\n// WEBPACK FOOTER //\n// ./server/db.js","import menu from './menu'\nimport category from './category'\nimport order from './order'\nimport coupon from './coupon'\nimport auth from './auth'\nimport user from './user'\nimport profile from './profile'\nimport upload from './upload'\nimport storage from './storage'\nimport options from './options'\nimport dummy from './dummy'\n\nexport default (app, prefix = '') => {\n  app.use(menu.prefix(prefix).routes())\n  app.use(category.prefix(prefix).routes())\n  app.use(order.prefix(prefix).routes())\n  app.use(coupon.prefix(prefix).routes())\n  app.use(auth.prefix(prefix).routes())\n  app.use(user.prefix(prefix).routes())\n  app.use(profile.prefix(prefix).routes())\n  app.use(upload.prefix(prefix).routes())\n  app.use(storage.prefix(prefix).routes())\n  app.use(options.prefix(prefix).routes())\n  app.use(dummy.prefix(prefix).routes())\n} \n\n\n// WEBPACK FOOTER //\n// ./server/routes/index.js","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 24\n// module chunks = 0","module.exports = require(\"https\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"https\"\n// module id = 25\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 26\n// module chunks = 0","module.exports = require(\"koa-body\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-body\"\n// module id = 27\n// module chunks = 0","module.exports = require(\"koa-force-ssl\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-force-ssl\"\n// module id = 28\n// module chunks = 0","module.exports = require(\"koa-mount\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-mount\"\n// module id = 29\n// module chunks = 0","module.exports = require(\"koa-static\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-static\"\n// module id = 30\n// module chunks = 0","module.exports = require(\"koa2-cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa2-cors\"\n// module id = 31\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 32\n// module chunks = 0","/**\n * Manual facebook login flow\n * https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow\n * http://localhost:3000/api/auth/facebook\n */\n\nexport default {\n  clientId: '1655272257894090',\n  clientSecret: '7971deaa031f28a9bffa5dba9e2d9bff',\n  callbackUrl: 'https://localhost/api/auth/facebook/callback',\n  profileFields: ['id', 'displayName', 'photos', 'email']\n}\n\n\n// WEBPACK FOOTER //\n// ./server/config/facebook.js","import CategoryService from './../services/category'\n\nexport function getCategories (ctx, next) {\n  return CategoryService.getCategories()\n  .then(categories => ctx.body = categories)\n}\n\nexport function createCategory (ctx, next) {\n  return CategoryService.createCategory(ctx.request.body)\n  .then(category => ctx.body = category)\n}\n\nexport function getCategory (ctx, next) {\n  return CategoryService.getCategory(ctx.params.id)\n  .then(category => ctx.body = category)\n}\n\nexport function updateCategory (ctx, next) {\n  return CategoryService.updateCategory(ctx.params.id, ctx.request.body)\n  .then(res => ctx.body = res)\n}\n\nexport function removeCategory (ctx, next) {\n  return CategoryService.removeCategory(ctx.params.id)\n  .then(res => ctx.body = res)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/category.js","import CouponService from './../services/coupon'\n\nexport function getCoupons (ctx, next) {\n  return CouponService.getCoupons()\n  .then(coupons => ctx.body = coupons)\n}\n\nexport function createCoupon (ctx, next) {\n  return CouponService.createCoupon(ctx.request.body)\n  .then(coupon => ctx.body = coupon)\n}\n\nexport function getCoupon (ctx, next) {\n  return CouponService.getCoupon(ctx.params.id)\n  .then(coupon => ctx.body = coupon)\n}\n\nexport function updateCoupon (ctx, next) {\n  return CouponService.updateCoupon(ctx.params.id, ctx.request.body)\n  .then(res => ctx.body = res)\n}\n\nexport function removeCoupon (ctx, next) {\n  return CouponService.removeCoupon(ctx.params.id)\n  .then(res => ctx.body = res)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/coupon.js","import MenuItemService from './../services/menuItem'\n\nexport function getMenuItems (ctx, next) {\n  const { category } = ctx.query\n  return MenuItemService.getMenuItems({ category })\n  .then(menuItems => ctx.body = menuItems)\n}\n\nexport function createMenuItem (ctx, next) {\n  return MenuItemService.createMenuItem(ctx.request.body)\n  .then(menuItem => ctx.body = menuItem)\n}\n\nexport function getMenuItem (ctx, next) {\n  return MenuItemService.getMenuItem(ctx.params.id)\n  .then(menuItem => ctx.body = menuItem)\n}\n\nexport function updateMenuItem (ctx, next) {\n  return MenuItemService.updateMenuItem(ctx.params.id, ctx.request.body)\n  .then(res => ctx.body = res)\n}\n\nexport function removeMenuItem (ctx, next) {\n  return MenuItemService.removeMenuItem(ctx.params.id)\n  .then(res => ctx.body = res)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/menuItem.js","import OptionsService from './../services/options'\n\nexport function getOptions (ctx, next) {\n  return OptionsService.getOptions()\n  .then(options => ctx.body = options)\n}\n\nexport function saveOptions (ctx, next) {\n  return OptionsService.saveOptions(ctx.request.body)\n  .then(res => ctx.body = res)\n}\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/options.js","import OrderService from './../services/order'\n\nexport function getOrders (ctx, next) {\n  // If is admin return all orders\n  const user = ctx.user.role === 'admin' ? null : ctx.user.id\n\n  return OrderService.getOrders({ user })\n  .then(orders => ctx.body = orders)\n}\n\nexport function createOrder (ctx, next) {\n  const user = ctx.user.id\n  const body = { ...ctx.request.body, user }\n\n  return OrderService.createOrder(body)\n  .then(order => ctx.body = order)\n}\n\nexport function getOrder (ctx, next) {\n  return OrderService.getOrder(ctx.params.id)\n  .then(order => ctx.body = order)\n}\n\nexport function updateOrder (ctx, next) {\n  return OrderService.updateOrder(ctx.params.id, ctx.request.body)\n  .then(res => ctx.body = res)\n}\n\nexport function removeOrder (ctx, next) {\n  return OrderService.removeOrder(ctx.params.id)\n  .then(res => ctx.body = res)\n}\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/order.js","import uuid from 'uuid'\n\nimport StorageService from './../services/storage'\n\nexport function uploadImage (ctx, next) {\n  const file = ctx.request.body.files && ctx.request.body.files.image || ''\n  const fileName = uuid()\n  \n  return StorageService.uploadImage(file, fileName)\n  .then(res => ctx.body = res)\n}\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/storage.js","import UploadService from './../services/upload'\n\nexport function uploadFeaturedImage (ctx, next) {\n  const file = ctx.request.body.files.image\n  const newFileName = Date.now() + '.jpg'\n\n  return UploadService.uploadImage(file, newFileName)\n  .then(res => {\n    ctx.body = res\n  })\n}\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/upload.js","import UserService from './../services/user'\n\nexport function getUsers (ctx) {\n  const { page, perPage } = ctx.params\n\n  return UserService.getUsers({ page, perPage })\n  .then(users => ctx.body = users)\n}\n\nexport function createUser (ctx) {\n  return UserService.createUser(ctx.request.body)\n  .then(user => ctx.body = user)\n}\n\nexport function getUser(ctx) {\n  return UserService.getUser(ctx.params.id)\n  .then(user => ctx.body = user)\n}\n\nexport function updateUser(ctx) {\n  return UserService.updateUser(ctx.params.id, ctx.request.body)\n  .then(res => ctx.body = res)\n}\n\nexport function deleteUser(ctx) {\n  return UserService.deleteUser(ctx.params.id)\n  .then(res => ctx.body = res)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/user.js","const categories = [\n  {\n    _id: '5a78c4169d3f2c2bc96c4205',\n    name: 'Pizzas',\n    slug: 'pizzas'\n  },\n  {\n    _id: '5a78c4169d3f2c2bc96c4206',\n    name: 'Soups',\n    slug: 'soups'\n  },\n  {\n    _id: '5a78c4169d3f2c2bc96c4207',\n    name: 'Salads',\n    slug: 'salads'\n  }\n]\n\n/*\n * MenuItems: Pizzas, Soups, Salads\n */\nconst pizzas = [\n  {\n    name: 'Mario',\n    description: 'Blat subțire. Sos de roșii, busuioc, ulei de măsline, maioneză, brânză Mozzarella, carne de pui, cașcaval Dor Blue, spanac, cârnăciori Cabanos, gogoșari.',\n    prices: [\n      {\n        name: 'Small',\n        price: 80\n      }\n    ],\n    weight: 500,\n    featuredImage: 'mario.jpg',\n    category: '5a78c4169d3f2c2bc96c4205',\n\n    optionGroups: [\n      {\n        name: 'Cascaval',\n        multiselect: true,\n        options: [\n          {\n            name: 'Cașcaval Edam 50g',\n            prices: [10]\n          },\n          {\n            name: 'Mozzarella 50g',\n            prices: [10]\n          },\n          {\n            name: 'Parmigiano 15g',\n            prices: [10]\n          }\n        ]\n      },\n      {\n        name: 'Carne',\n        multiselect: true,\n        options: [\n          {\n            name: 'Jambon de Tambov 50g',\n            prices: [15]\n          },\n          {\n            name: 'Piept de pui 50g',\n            prices: [10]\n          },\n          {\n            name: 'Salami 30g',\n            prices: [20]\n          }\n        ]\n      }\n    ]\n  },\n  {\n    name: 'Siciliana',\n    description: 'Brânză mozzarella, jambon de “tambov”, ciuperci coapte, anghinare coapte, măsline kalamata, sos de pizza.',\n    prices: [\n      {\n        name: 'Small',\n        price: 50\n      },\n      {\n        name: 'Medium',\n        price: 80\n      },\n      {\n        name: 'Big',\n        price: 100\n      }\n    ],\n    weight: 520,\n    featuredImage: 'sicilian.jpg',\n    category: '5a78c4169d3f2c2bc96c4205',\n\n    optionGroups: [\n      {\n        name: 'Cascaval',\n        multiselect: true,\n        options: [\n          {\n            name: 'Cașcaval Edam 50g',\n            prices: [10, 15, 20]\n          },\n          {\n            name: 'Mozzarella 50g',\n            prices: [5, 8, 10]\n          },\n          {\n            name: 'Parmigiano 15g',\n            prices: [5]\n          }\n        ]\n      },\n      {\n        name: 'Carne',\n        multiselect: false,\n        options: [\n          {\n            name: 'Jambon de Tambov 50g',\n            prices: [15]\n          },\n          {\n            name: 'Piept de pui 50g',\n            prices: [20, 30, 40]\n          },\n          {\n            name: 'Salami 30g',\n            prices: [20]\n          }\n        ]\n      }\n    ]\n  }\n]\n\nconst soups = [\n  {\n    name: 'Zeamă de pui',\n    description: 'Bulion de pui, file de pui, verdeaţă, roşii, tăiţei de casă, ardei gras, rădăcină de țelină, pătrunjel, smântână, ardei iute.',\n    prices: [{ name: '', price: 45 }],\n    weight: 460,\n    featuredImage: 'zeama.jpg',\n    category: '5a78c4169d3f2c2bc96c4206'\n  },\n  {\n    name: 'Supă-cremă de pui',\n    description: 'Bulion de pui, pulpă de pui, ciuperci champignon, sos bechamel, smântână lichidă, ulei de măsline, piper negru, pătrunjel. Se serveşte în chiflă.',\n    prices: [{ name: '', price: 53 }],\n    weight: 430,\n    featuredImage: 'supa.jpg',\n    category: '5a78c4169d3f2c2bc96c4206'\n  },\n  {\n    name: 'Supă-cremă de fasole',\n    description: 'Bulion de legume, fasole, usturoi, pesmeți, ceapă verde, piper negru, ulei de măsline.',\n    prices: [{ name: '', price: 40 }],\n    weight: 350,\n    featuredImage: 'supa.jpg',\n    category: '5a78c4169d3f2c2bc96c4206',\n\n    optionGroups: [\n      {\n        name: 'Temperatura',\n        multiselect: false,\n        options: [\n          {\n            name: 'Rece',\n            prices: [0]\n          },\n          {\n            name: 'Calda',\n            prices: [1]\n          }\n        ]\n      }\n    ]\n  }\n]\n\n/*\n * Merge MenuItems from all categories.\n */\nconst menuItems = [\n  ...pizzas,\n  ...soups\n]\n\nmodule.exports = {\n  menuItems,\n  categories\n}\n\n\n// WEBPACK FOOTER //\n// ./server/dummy/index.js","import mongoose from 'mongoose'\n\nimport schemaMethods from './methods/coupon'\nimport schemaValidate from './validate/coupon'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst CouponSchema = new Schema({\n  _id: { type: String, required: true }, // _id is code\n  discountType: { type: String, required: true, enum: ['percent', 'number'], default: 'percent' }, // percent or number\n  discount: { type: Number, required: true }\n}, { versionKey: false })\n\n/*\n * Plugins\n */\nCouponSchema.plugin(schemaMethods) // schema methods\nCouponSchema.plugin(schemaValidate) // schema validation\n\nexport default mongoose.model('Coupon', CouponSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/Coupon.js","import mongoose from 'mongoose'\n\nimport { currencies } from './util/options'\nimport schemaMethods from './methods/options'\nimport schemaValidate from './validate/options'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst OptionSchema = new Schema({\n  _id: { type: String, required: true }, // options\n\n  // general options\n  deliveryPrice: { type: Number, default: 0 },\n  freeShippingFrom: { type: Number, default: 0 },\n  deliveryTime: { type: Number }, // in minutes\n\n  // store options\n  storeAddress1: String,\n  storeAddress2: String,\n  storeCity: String,\n  storeCountry: String,\n  storePostcode: String,\n\n  // currency options\n  currency: { type: String, enum: currencies, default: 'USD' },\n  currencyPosition: { type: String, enum: ['left', 'right', 'leftSpace', 'rightSpace'], default: 'left' },\n  currencyThSeperator: { type: String, enum: [',', '.'], default: '.' }, // Thousand separator\n  currencyDecSeperator: { type: String, enum: [',', '.'], default: ',' }, // Decimal separator\n  currencyNumDec: { type: Number, default: 2 },\n\n  // payment options\n  paymentStripeKey: String,\n  paymentPaypalKey: String\n}, { versionKey: false })\n\n/*\n * Plugins\n */\nOptionSchema.plugin(schemaMethods) // schema methods\nOptionSchema.plugin(schemaValidate) // schema validation\n\nexport default mongoose.model('Options', OptionSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/Options.js","import mongoose from 'mongoose'\n\nimport OrderItem from './types/OrderItem'\nimport schemaMethods from './methods/order'\nimport schemaValidate from './validate/order'\nimport { getTotalPrice, getDiscountPrice } from './util/order'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst OrderSchema = new Schema({\n  items: [OrderItem],\n  coupon: { type: String, ref: 'Coupon' },\n  source: String,\n  methods: { type: String, enum: ['cash', 'stripe', 'paypal'], default: 'cash' },\n  status: { type: String, enum: ['pending', 'failed', 'processing', 'completed', 'canceled', 'ontheway'], default: 'pending' }, // https://docs.woocommerce.com/document/managing-orders/\n  user: { type: ObjectId, ref: 'User' }\n}, { versionKey: false, timestamps: true, toObject: { virtuals: true }, toJSON: { virtuals: true } })\n\n/*\n * Virtuals\n */\nOrderSchema.virtual('subtotal').get(function () {\n  // return getTotalPrice(this.items)\n  let subtotal = 0\n  this.items.forEach(lineItem => {\n    subtotal += lineItem.lineItemTotal\n  })\n  return subtotal\n})\n\nOrderSchema.virtual('total').get(function () {\n  return getDiscountPrice(this.subtotal, this.coupon)\n})\n\n/*\n * Plugins\n */\nOrderSchema.plugin(schemaMethods) // schema methods\nOrderSchema.plugin(schemaValidate) // schema validation\n\nexport default mongoose.model('Order', OrderSchema)\n\n\n// WEBPACK FOOTER //\n// ./server/models/Order.js","export default (schema, options) => {\n  schema.statics.getCategories = function () {\n    return this.find({}).exec()\n  }\n\n  schema.statics.getCategory = function (id) {\n    return this.findById(id).exec()\n  }\n\n  schema.statics.updateCategory = function (id, payload) {\n    return this.findByIdAndUpdate(id, payload).exec()\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/methods/category.js","export default (schema, options) => {\n  schema.statics.getCoupons = function () {\n    return this.find({}).exec()\n  }\n\n  schema.statics.getCoupon = function (id) {\n    return this.findById(id).exec()\n  }\n\n  schema.statics.updateCoupon = function (id, payload) {\n    return this.findByIdAndUpdate(id, payload).exec()\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/methods/coupon.js","export default (schema, options) => {\n  schema.statics.getMenuItems = function ({ category }) {\n    let query = {}\n    if (category) {\n      query.category = category\n    }\n    return this.find(query).sort({ createdAt: -1 }).populate(['category']).exec()\n  }\n\n  schema.statics.getMenuItem = function (id) {\n    return this.findById(id).exec()\n  }\n\n  schema.statics.updateMenuItem = function (id, payload) {\n    return this.findByIdAndUpdate(id, payload).exec()\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/methods/menuItem.js","export default (schema, options) => {\n  schema.statics.getOptions = function () {\n    return this.findOne({ _id: 'options' }).exec()\n    .then(options => {\n      if (options) {\n        return options\n      } else {\n        return {}\n      }\n    })\n  }\n\n  schema.statics.updateOptions = function (payload) {\n    payload._id = 'options'\n    return this.update({ _id: 'options' }, payload, { upsert: true, setDefaultsOnInsert: true, runValidators: true }).exec()\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/methods/options.js","export default (schema, options) => {\n  schema.statics.getOrders = function (options) {\n    return this.find(options)\n    .select({ source: 1, items: 1, coupon: 1, status: 1, createdAt: 1, updatedAt: 1 })\n    .populate({ path: 'items.menuItem', select: { pizzaGroups: 0 } })\n    .populate({ path: 'user', select: { _id: 1, email: 1, firstName: 1, lastName: 1, shipAddress: 1 } })\n    .populate({ path: 'coupon', select: { _id: 1, code: 1, discount: 1, discountType: 1 } })\n    .exec()\n  }\n\n  schema.statics.getOrder = function (id) {\n    return this.findById(id)\n    .select({ source: 1, items: 1, coupon: 1, status: 1, createdAt: 1, updatedAt: 1 })\n    .populate({ path: 'items.menuItem', select: { pizzaGroups: 0 } })\n    .populate({ path: 'user', select: { _id: 1, email: 1, firstName: 1, lastName: 1, shipAddress: 1 } })\n    .populate({ path: 'coupon', select: { _id: 1, code: 1, discount: 1, discountType: 1 } })\n    .exec()\n  }\n\n  schema.statics.updateOrder = function (id, payload) {\n    // return this.findByIdAndUpdate(id, payload).exec() // need to return new document after update\n    return this.findOneAndUpdate({ _id: id }, { $set: payload }, { new: true })\n    .populate({ path: 'items.menuItem', select: { pizzaGroups: 0 } })\n    .populate({ path: 'user', select: { _id: 1, email: 1, firstName: 1, lastName: 1, shipAddress: 1 } })\n    .populate({ path: 'coupon', select: { _id: 1, code: 1, discount: 1, discountType: 1 } })\n    .exec()\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/methods/order.js","import crypto from 'crypto'\n\n// https://habrahabr.ru/post/324066/\nexport default (schema, options) => {\n\n  schema.virtual('password')\n  .set(function (password) {\n    this._plainPassword = password\n    if (password) {\n      this.salt = crypto.randomBytes(128).toString('base64')\n      this.passwordHash = crypto.pbkdf2Sync(password, this.salt, 1, 128, 'sha1')\n    } else {\n      this.salt = undefined\n      this.passwordHash = undefined\n    }\n  })\n  .get(function () {\n    return this._plainPassword\n  })\n\n  schema.methods.checkPassword = function (password) {\n    if (!password) return false\n    if (!this.passwordHash) return false\n    return crypto.pbkdf2Sync(password, this.salt, 1, 128, 'sha1') == this.passwordHash\n  }\n  \n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/methods/user.js","import mongoose from 'mongoose'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst MenuItemPriceSchema = new Schema({\n  name: String,\n  price: Number\n}, { versionKey: false })\n\nexport default MenuItemPriceSchema\n\n\n// WEBPACK FOOTER //\n// ./server/models/types/MenuItemPrice.js","import mongoose from 'mongoose'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst OptionSchema = new Schema({\n  name: String,\n  price: Number,\n  prices: [Number]\n}, { versionKey: false })\n\nexport default OptionSchema\n\n\n// WEBPACK FOOTER //\n// ./server/models/types/Option.js","import mongoose from 'mongoose'\n\nimport Option from './Option'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst OptionGroupSchema = new Schema({\n  name: String,\n  multiselect: Boolean,\n  min: Boolean,\n  max: Boolean,\n  options: [Option]\n}, { versionKey: false })\n\nexport default OptionGroupSchema\n\n\n// WEBPACK FOOTER //\n// ./server/models/types/OptionGroup.js","import mongoose from 'mongoose'\n\nimport OrderOptionGroup from './OrderOptionGroup'\nimport { getMenuItemPrice } from './../util/order'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst OrderItemSchema = new Schema({\n  quantity: Number,\n  size: String,\n  optionGroups: [OrderOptionGroup],\n  menuItem: { type: ObjectId, ref: 'MenuItem' }\n}, { versionKey: false, toObject: { virtuals: true }, toJSON: { virtuals: true } })\n\nOrderItemSchema.virtual('itemPrice').get(function () {\n  const price = getMenuItemPrice(this.menuItem, this.size)\n\n  return price\n})\n\nOrderItemSchema.virtual('optionsTotalPrice').get(function () {\n  let total = 0\n\n  this.optionGroups.forEach(optionGroup => {\n    total += optionGroup.groupTotalPrice\n  })\n\n  return total\n})\n\nOrderItemSchema.virtual('lineItemPrice').get(function () {\n  return this.itemPrice + this.optionsTotalPrice\n})\n\nOrderItemSchema.virtual('lineItemTotal').get(function () {\n  return this.lineItemPrice * this.quantity\n})\n\n\nexport default OrderItemSchema\n\n\n// WEBPACK FOOTER //\n// ./server/models/types/OrderItem.js","import mongoose from 'mongoose'\n\nimport { getOptionPrice, getOptionById } from './../util/order'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst OrderOptionSchema = new Schema({\n  id: String, // OptionID\n  quantity: Number\n}, { versionKey: false, toObject: { virtuals: true }, toJSON: { virtuals: true } })\n\nOrderOptionSchema.virtual('optionRef').get(function () {\n  const lineItem = this.parent().parent()\n  const optionGroupId = this.parent().group\n  const optionId = this.id\n\n  return getOptionById(lineItem.menuItem, optionGroupId, optionId)\n})\n\nOrderOptionSchema.virtual('unitPrice').get(function () {\n  const lineItem = this.parent().parent()\n  const optionGroup = this.parent()\n\n  return getOptionPrice(lineItem.menuItem, optionGroup.group, this.id, lineItem.size)\n})\n\nOrderOptionSchema.virtual('optionTotalPrice').get(function () {\n  return this.unitPrice * this.quantity\n})\n\nexport default OrderOptionSchema\n\n\n// WEBPACK FOOTER //\n// ./server/models/types/OrderOption.js","import mongoose from 'mongoose'\n\nimport OrderOption from './OrderOption'\nimport { getOptionGroupById } from './../util/order'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst OrderOptionGroupSchema = new Schema({\n  id: String, // OptionGroupID\n  options: [OrderOption]\n}, { versionKey: false, toObject: { virtuals: true }, toJSON: { virtuals: true } })\n\nOrderOptionGroupSchema.virtual('groupRef').get(function () {\n  const lineItem = this.parent()\n  const optionGroupId = this.id\n\n  return getOptionGroupById(lineItem.menuItem, optionGroupId)\n})\n\nOrderOptionGroupSchema.virtual('groupTotalPrice').get(function () {\n  let total = 0\n  this.options.forEach(option => {\n    total += option.optionTotalPrice\n  })\n  return total\n})\n\nexport default OrderOptionGroupSchema\n\n\n// WEBPACK FOOTER //\n// ./server/models/types/OrderOptionGroup.js","import mongoose from 'mongoose'\n\nconst Schema = mongoose.Schema\nconst ObjectId = Schema.ObjectId\n\nconst UserShipAddressSchema = new Schema({\n  firstName: String,\n  lastName: String,\n  // city: String,\n  street: String,\n  streetNumber: String,\n  entrance: String,\n  level: String,\n  apartment: String,\n\n  entranceCode: String\n}, { versionKey: false })\n\nexport default UserShipAddressSchema\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/types/UserShipAddress.js","import cc from 'currency-codes'\n\nexport const currencies = cc.codes()\n\n// export const currencies = [\n//   \"AED\",\n//   \"AFN\",\n//   \"ALL\",\n//   \"AMD\",\n//   \"ANG\",\n//   \"AOA\",\n//   \"ARS\",\n//   \"AUD\",\n//   \"AWG\",\n//   \"AZN\",\n//   \"BAM\",\n//   \"BBD\",\n//   \"BDT\",\n//   \"BGN\",\n//   \"BHD\",\n//   \"BIF\",\n//   \"BMD\",\n//   \"BND\",\n//   \"BOB\",\n//   \"BOV\",\n//   \"BRL\",\n//   \"BSD\",\n//   \"BTN\",\n//   \"BWP\",\n//   \"BYR\",\n//   \"BZD\",\n//   \"CAD\",\n//   \"CDF\",\n//   \"CHE\",\n//   \"CHF\",\n//   \"CHW\",\n//   \"CLF\",\n//   \"CLP\",\n//   \"CNY\",\n//   \"COP\",\n//   \"COU\",\n//   \"CRC\",\n//   \"CUC\",\n//   \"CUP\",\n//   \"CVE\",\n//   \"CZK\",\n//   \"DJF\",\n//   \"DKK\",\n//   \"DOP\",\n//   \"DZD\",\n//   \"EGP\",\n//   \"ERN\",\n//   \"ETB\",\n//   \"EUR\",\n//   \"FJD\",\n//   \"FKP\",\n//   \"GBP\",\n//   \"GEL\",\n//   \"GHS\",\n//   \"GIP\",\n//   \"GMD\",\n//   \"GNF\",\n//   \"GTQ\",\n//   \"GYD\",\n//   \"HKD\",\n//   \"HNL\",\n//   \"HRK\",\n//   \"HTG\",\n//   \"HUF\",\n//   \"IDR\",\n//   \"ILS\",\n//   \"INR\",\n//   \"IQD\",\n//   \"IRR\",\n//   \"ISK\",\n//   \"JMD\",\n//   \"JOD\",\n//   \"JPY\",\n//   \"KES\",\n//   \"KGS\",\n//   \"KHR\",\n//   \"KMF\",\n//   \"KPW\",\n//   \"KRW\",\n//   \"KWD\",\n//   \"KYD\",\n//   \"KZT\",\n//   \"LAK\",\n//   \"LBP\",\n//   \"LKR\",\n//   \"LRD\",\n//   \"LSL\",\n//   \"LTL\",\n//   \"LVL\",\n//   \"LYD\",\n//   \"MAD\",\n//   \"MDL\",\n//   \"MGA\",\n//   \"MKD\",\n//   \"MMK\",\n//   \"MNT\",\n//   \"MOP\",\n//   \"MRO\",\n//   \"MUR\",\n//   \"MVR\",\n//   \"MWK\",\n//   \"MXN\",\n//   \"MXV\",\n//   \"MYR\",\n//   \"MZN\",\n//   \"NAD\",\n//   \"NGN\",\n//   \"NIO\",\n//   \"NOK\",\n//   \"NPR\",\n//   \"NZD\",\n//   \"OMR\",\n//   \"PAB\",\n//   \"PEN\",\n//   \"PGK\",\n//   \"PHP\",\n//   \"PKR\",\n//   \"PLN\",\n//   \"PYG\",\n//   \"QAR\",\n//   \"RON\",\n//   \"RSD\",\n//   \"RUB\",\n//   \"RWF\",\n//   \"SAR\",\n//   \"SBD\",\n//   \"SCR\",\n//   \"SDG\",\n//   \"SEK\",\n//   \"SGD\",\n//   \"SHP\",\n//   \"SLL\",\n//   \"SOS\",\n//   \"SRD\",\n//   \"SSP\",\n//   \"STD\",\n//   \"SYP\",\n//   \"SZL\",\n//   \"THB\",\n//   \"TJS\",\n//   \"TMT\",\n//   \"TND\",\n//   \"TOP\",\n//   \"TRY\",\n//   \"TTD\",\n//   \"TWD\",\n//   \"TZS\",\n//   \"UAH\",\n//   \"UGX\",\n//   \"USD\",\n//   \"USN\",\n//   \"USS\",\n//   \"UYI\",\n//   \"UYU\",\n//   \"UZS\",\n//   \"VEF\",\n//   \"VND\",\n//   \"VUV\",\n//   \"WST\",\n//   \"XAF\",\n//   \"XAG\",\n//   \"XAU\",\n//   \"XBA\",\n//   \"XBB\",\n//   \"XBC\",\n//   \"XBD\",\n//   \"XBT\",\n//   \"XCD\",\n//   \"XDR\",\n//   \"XFU\",\n//   \"XOF\",\n//   \"XPD\",\n//   \"XPF\",\n//   \"XPT\",\n//   \"XTS\",\n//   \"XXX\",\n//   \"YER\",\n//   \"ZAR\",\n//   \"ZMW\"\n// ]\n\n\n// WEBPACK FOOTER //\n// ./server/models/util/options.js","export default function transformID (doc, ret) {\n  ret.id = ret._id\n  delete ret._id\n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/util/transformID.js","export default (schema, options) => {\n  \n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/validate/category.js","export default (schema, options) => {\n  \n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/validate/coupon.js","export default (schema, options) => {\n  \n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/validate/menuItem.js","export default (schema, options) => {\n  \n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/validate/options.js","export default (schema, options) => {\n  \n}\n\n\n// WEBPACK FOOTER //\n// ./server/models/validate/order.js","import Router from 'koa-router'\nimport passport from 'passport'\nimport validate from 'koa-joi-validate'\n\nimport validations from './validation/profile'\nimport { authenticate, authenticateFacebook } from './../config/passport'\nimport { registerUser } from './../controllers/profile'\n\nconst router = new Router()\n\n/*\n * Login.\n */\nrouter.post('/login', validate(validations.create), authenticate())\n\n/**\n * Register\n */\nrouter.post('/register', validate(validations.create), registerUser)\n\n/**\n * Facebok login redirect.\n */\nrouter.get('/auth/facebook', passport.authenticate('facebook', {\n  scope: [\n    'public_profile',\n    'email'\n  ],\n}))\n\n/**\n * Facebok login callback.\n */\nrouter.get('/auth/facebook/callback', authenticateFacebook())\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/auth.js","import Router from 'koa-router'\n\nimport { authorize } from './../config/passport'\nimport user from './../middlewares/roles'\nimport { getCategories, createCategory, getCategory, updateCategory, removeCategory } from './../controllers/category'\n\nconst router = new Router()\n\n/*\n * List Categories.\n */\nrouter.get('/category', getCategories)\n\n/*\n * Create a Category.\n */\nrouter.post('/category', authorize(), user.can('access admin'), createCategory)\n\n/*\n * Retrieve a Category.\n */\nrouter.get('/category/:id', getCategory)\n\n/*\n * Update a Category.\n */\nrouter.put('/category/:id', authorize(), user.can('access admin'), updateCategory)\n\n/*\n * Delete a Category.\n */\nrouter.delete('/category/:id', authorize(), user.can('access admin'), removeCategory)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/category.js","import Router from 'koa-router'\n\nimport { authorize } from './../config/passport'\nimport user from './../middlewares/roles'\nimport { getCoupons, createCoupon, getCoupon, updateCoupon, removeCoupon } from './../controllers/coupon'\n\nconst router = new Router()\n\n/*\n * List Coupons.\n */\nrouter.get('/coupon', getCoupons)\n\n/*\n * Create an Coupon.\n */\nrouter.post('/coupon', authorize(), user.can('access admin'), createCoupon)\n\n/*\n * Retrieve an Coupon.\n */\nrouter.get('/coupon/:id', getCoupon)\n\n/*\n * Update an Coupon.\n */\nrouter.put('/coupon/:id', authorize(), user.can('access admin'), updateCoupon)\n\n/*\n * Delete an Coupon.\n */\nrouter.delete('/coupon/:id', authorize(), user.can('access admin'), removeCoupon)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/coupon.js","import Router from 'koa-router'\n\nimport { authorize } from './../config/passport'\nimport user from './../middlewares/roles'\nimport MenuItem from './../models/MenuItem'\nimport Category from './../models/Category'\nimport dummy from './../dummy'\n\nconst router = new Router()\n\n\n/*\n * Import Dummy Categories.\n */\nrouter.get('/dummy/categories', authorize(), user.can('access admin'), async ctx => {\n  try {\n    console.log('Saving categories...')\n    dummy.categories.map(item => {\n      const category = new Category(item)\n      const result = category.save()\n      console.log(result)\n    })\n  } catch(err) {\n    ctx.throw(400, err)\n  }\n})\n\n/*\n * Import Dummy MenuItems.\n */\nrouter.get('/dummy/menu', authorize(), user.can('access admin'), async ctx => {\n  try {\n    console.log('Saving menuItems...')\n    dummy.menuItems.map(item => {\n      const menuItem = new MenuItem(item)\n      const result = menuItem.save()\n      console.log(result)\n    })\n\n  } catch(err) {\n    ctx.throw(400, err)\n  }\n})\n\n\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/routes/dummy.js","import Router from 'koa-router'\n\nimport { authorize } from './../config/passport'\nimport user from './../middlewares/roles'\nimport { getMenuItems, createMenuItem, getMenuItem, updateMenuItem, removeMenuItem } from './../controllers/menuItem'\n\nconst router = new Router()\n\n// http://docs.opendining.net/api/#!/menuitems.js/getMenuItem_get_0\n\n/*\n * List MenuItems.\n */\nrouter.get('/menu', getMenuItems)\n\n/*\n * Create a MenuItem.\n */\nrouter.post('/menu', authorize(), user.can('access admin'), createMenuItem)\n\n/*\n * Retrieve a MenuItem.\n */\nrouter.get('/menu/:id', getMenuItem)\n\n/*\n * Update a MenuItem.\n */\nrouter.put('/menu/:id', authorize(), user.can('access admin'), updateMenuItem)\n\n/*\n * Delete a MenuItem.\n */\nrouter.delete('/menu/:id', authorize(), user.can('access admin'), removeMenuItem)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/menu.js","import Router from 'koa-router'\n\nimport { authorize } from './../config/passport'\nimport user from './../middlewares/roles'\nimport { getOptions, saveOptions } from './../controllers/options'\n\nconst router = new Router()\n\n/*\n * Get Options.\n */\nrouter.get('/options', getOptions)\n\n/*\n * Update Options.\n */\nrouter.post('/options', authorize(), user.can('access admin'), saveOptions)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/options.js","import Router from 'koa-router'\n//import validate from 'express-validation'\n\nimport { authorize } from './../config/passport'\nimport { getOrders, createOrder, getOrder, updateOrder, removeOrder } from './../controllers/order'\nimport user from './../middlewares/roles'\n\nconst router = new Router()\n\n/*\n * List Orders.\n */\nrouter.get('/order', authorize(), getOrders)\n\n/*\n * Create an Order.\n */\nrouter.post('/order', authorize(), createOrder)\n\n/*\n * Retrieve an Order.\n */\nrouter.get('/order/:id', authorize(), user.can('access order'), getOrder)\n\n/*\n * Update an Order.\n */\nrouter.put('/order/:id', authorize(), user.can('access order'), updateOrder)\n\n/*\n * Delete an Order.\n */\nrouter.delete('/order/:id', authorize(), user.can('access order'), removeOrder)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/order.js","import Router from 'koa-router'\nimport passport from 'passport'\nimport validate from 'koa-joi-validate'\n\nimport validations from './validation/profile'\nimport { authorize } from './../config/passport'\nimport { getProfile, updateProfile } from './../controllers/profile'\n\nconst router = new Router()\n\n/*\n * Retrieve profile.\n */\nrouter.get('/profile', authorize(), getProfile)\n\n/*\n * Update profile.\n */\nrouter.put('/profile', authorize(), validate(validations.update), updateProfile)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/profile.js","import Router from 'koa-router'\n\nimport { authorize } from './../config/passport'\nimport user from './../middlewares/roles'\nimport { uploadImage } from './../controllers/storage'\n\nconst router = new Router()\n\nrouter.post('/storage/upload', authorize(), user.can('access admin'), uploadImage)\n\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/routes/storage.js","import Router from 'koa-router'\n\nimport { authorize } from './../config/passport'\nimport user from './../middlewares/roles'\nimport { uploadFeaturedImage } from './../controllers/upload'\n\nconst router = new Router\n\nrouter.post('/upload', authorize(), user.can('access admin'), uploadFeaturedImage)\n\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/routes/upload.js","import Router from 'koa-router'\n\nimport { authorize } from './../config/passport'\nimport user from './../middlewares/roles'\nimport { getUsers, createUser, getUser, updateUser, deleteUser } from './../controllers/user'\n\nconst router = new Router()\n\n/*\n * List Users.\n */\nrouter.get('/user', authorize(), user.can('access admin'), getUsers)\n\n/*\n * Create an User.\n */\nrouter.post('/user', authorize(), user.can('access admin'), createUser)\n\n/*\n * Retrieve an User.\n */\nrouter.get('/user/:id', authorize(), user.can('access admin'), getUser)\n\n/*\n * Update an User.\n */\nrouter.put('/user/:id', authorize(), user.can('access admin'), updateUser)\n\n/*\n * Delete an User.\n */\nrouter.delete('/user/:id', authorize(), user.can('access admin'), deleteUser)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/user.js","import Category from './../models/Category'\nimport AppError from './../errors/AppError'\n\nexport default {\n  getCategories () {\n    return Category.getCategories({})\n  },\n\n  createCategory (payload) {\n    return new Category(payload).save()\n  },\n\n  getCategory (id) {\n    return Category.getCategory(id)\n    .then(category => {\n      if (!category) throw new AppError('Item not found', 404)\n      return category\n    })\n  },\n\n  updateCategory (id, payload) {\n    return Category.updateCategory(id, payload)\n    .then(category => {\n      if (!category) throw new AppError('Item not found', 404)\n      return category\n    })\n  },\n\n  removeCategory (id) {\n    return Category.findByIdAndRemove(id)\n    .then(category => {\n      if (!category) throw new AppError('Item not found', 404)\n      return category\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/services/category.js","import Coupon from './../models/Coupon'\nimport AppError from './../errors/AppError'\n\nexport default {\n  getCoupons () {\n    return Coupon.getCoupons({})\n  },\n\n  createCoupon (payload) {\n    return new Coupon(payload).save()\n  },\n\n  getCoupon (id) {\n    return Coupon.getCoupon(id)\n    .then(coupon => {\n      if (!coupon) throw new AppError('Item not found', 404)\n      return coupon\n    })\n  },\n\n  updateCoupon (id, payload) {\n    return Coupon.updateCoupon(id, payload)\n    .then(coupon => {\n      if (!coupon) throw new AppError('Item not found', 404)\n      return coupon\n    })\n  },\n\n  removeCoupon (id) {\n    return Coupon.findByIdAndRemove(id)\n    .then(coupon => {\n      if (!coupon) throw new AppError('Item not found', 404)\n      return coupon\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/services/coupon.js","import MenuItem from './../models/MenuItem'\nimport AppError from './../errors/AppError'\n\nexport default {\n  getMenuItems ({ category }) {\n    return MenuItem.getMenuItems({ category })\n  },\n\n  createMenuItem (payload) {\n    return new MenuItem(payload).save()\n  },\n\n  getMenuItem (id) {\n    return MenuItem.getMenuItem(id)\n    .then(menuItem => {\n      if (!menuItem) throw new AppError('Item not found', 404)\n      return menuItem\n    })\n  },\n\n  updateMenuItem (id, payload) {\n    return MenuItem.updateMenuItem(id, payload)\n    .then(menuItem => {\n      if (!menuItem) throw new AppError('Item not found', 404)\n      return menuItem\n    })\n  },\n\n  removeMenuItem (id) {\n    return MenuItem.findByIdAndRemove(id)\n    .then(menuItem => {\n      if (!menuItem) throw new AppError('Item not found', 404)\n      return menuItem\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/services/menuItem.js","import Options from './../models/Options'\nimport AppError from './../errors/AppError'\n\nexport default {\n  getOptions () {\n   return Options.getOptions()\n  },\n  saveOptions (payload) {\n    return Options.updateOptions(payload)\n    .then(options => {\n      if (!options) throw new AppError('Options not found', 404)\n      return options\n    })\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/services/options.js","import User from './../models/User'\nimport AppError from './../errors/AppError'\nimport { generateJWT } from './../config/passport'\n\nconst selectedFields = {\n  'id': 1,\n  'firstName': 1,\n  'lastName': 1,\n  'email': 1,\n  'phone': 1,\n  'shipAddress': 1\n}\n\nexport default {\n  registerUser (payload) {\n    return User.create(payload)\n    .then(user => {\n      if (user) {\n        const token = generateJWT(user)\n        return { user: {\n          id: user.id,\n          firstName: user.firstName,\n          lastName: user.lastName,\n          email: user.email,\n        }, token }\n      } else {\n        throw new AppError('Can not create new User', 400)\n      }\n    })\n    .catch(err => {\n      throw new AppError('This user already exists', 400)\n    })\n  },\n  getProfile (id) {\n    return User.findById(id, selectedFields).exec()\n    .then(user => {\n      if (user) {\n        return user\n      } else {\n        throw new AppError('This user was disabled by admin', 400)\n      }\n    })\n  },\n  updateProfile (id, payload) {\n    return User.findByIdAndUpdate(id, payload, { select: selectedFields, new: true }).exec()\n    .then(res => {\n      if (!res) throw new AppError('Item not found', 404)\n      return res\n    })\n  },\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/services/profile.js","import fs from 'fs'\nimport AWS from 'aws-sdk'\n\nimport AppError from './../errors/AppError'\n\nAWS.config.update({\n  accessKeyId: process.env.AWS_ACCESS_KEY,\n  secretAccessKey: process.env.AWS_SECRET_KEY,\n  region: process.env.AWS_REGION\n})\n\nconst s3 = new AWS.S3()\n\nexport default {\n  uploadImage (file, name) {\n    return new Promise((resolve, reject) => {\n\n      if (!file || !name) return reject(new AppError('Missing file or filename', 400))\n      if (file.type !== 'image/png' && file.type !== 'image/jpeg') return reject(new AppError('Only data type image/png allowed', 400))\n\n      fs.readFile(file.path, (err, data) => {\n\n        if (err) return reject(new AppError(err.message, 500))\n        if (!data) return reject(new AppError('The file is empty', 400))\n        s3.upload({\n          Key: name,\n          Body: data,\n          ContentType: file.type,\n          Bucket: process.env.AWS_BUCKET\n        }, (err, data) => {\n          console.log('AWS S3 data', data)\n          if (err) return reject(new AppError(err.message, 500))\n          if (data) return resolve({ location: data.Location, key: data.Key })\n          reject(new AppError('Unexpected error', 500))\n        })\n\n      })\n\n    })\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/services/storage.js","import fs from 'fs'\nimport path from 'path'\n\nexport default {\n  uploadImage (file, filename) {\n    \n    const newFilePath = path.join(__dirname, './../static/' + filename)\n\n    return new Promise((resolve, reject) => {\n      fs.readFile(file.path, (err, data) => {\n        if (err) return reject(err)\n          fs.writeFile(newFilePath, data, (err) => {\n            if (err) return reject(err)\n              fs.unlink(file.path, (err) => {\n                if (err) return reject(err)\n                resolve({ file: `/static/${filename}` })\n              })\n          })\n      })\n    })\n\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./server/services/upload.js","module.exports = require(\"aws-sdk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"aws-sdk\"\n// module id = 84\n// module chunks = 0","module.exports = require(\"crypto\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"crypto\"\n// module id = 85\n// module chunks = 0","module.exports = require(\"currency-codes\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"currency-codes\"\n// module id = 86\n// module chunks = 0","module.exports = require(\"joi\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"joi\"\n// module id = 87\n// module chunks = 0","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 88\n// module chunks = 0","module.exports = require(\"koa-roles\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-roles\"\n// module id = 89\n// module chunks = 0","module.exports = require(\"passport-facebook\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-facebook\"\n// module id = 90\n// module chunks = 0","module.exports = require(\"passport-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local\"\n// module id = 91\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 92\n// module chunks = 0","module.exports = require(\"uuid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"uuid\"\n// module id = 93\n// module chunks = 0","import dotenv from 'dotenv/config'\nimport Koa from 'koa'\nimport bodyParser from 'koa-body'\nimport mount from 'koa-mount'\nimport serve from 'koa-static'\nimport cors from 'koa2-cors'\nimport passport from 'koa-passport'\nimport path from 'path'\nimport { Nuxt, Builder } from 'nuxt'\nimport http from 'http'\nimport https from 'https'\nimport forceSSL from 'koa-force-ssl'\nimport fs from 'fs'\n\nimport Routes from './routes'\nimport db from './db'\nimport passportStrategy from './config/passport'\nimport roles from './middlewares/roles'\n\nasync function start () {\n\n  const app = new Koa()\n  const host = process.env.HOST\n  const port = process.env.PORT\n\n  // Catch errors\n  app.use(async (ctx, next) => {\n    try {\n      await next();\n    } catch (err) {\n      ctx.status = err.status || 500;\n      ctx.body = { error: err.message };\n      ctx.app.emit('error', err, ctx);\n    }\n  });\n\n  // Force SSL on all page\n  // app.use(forceSSL())\n\n  // Register middlewares\n  app.use(cors({ origin: '*' }))\n  app.use(bodyParser({ multipart: true }))\n  app.use(mount('/static', serve(path.join(__dirname, '/static'))))\n  app.use(passport.initialize())\n\n  // Koa roles\n  app.use(roles.middleware())\n\n  // Register routes\n  Routes(app, '/api')\n\n  // Import and Set Nuxt.js options\n  let config = require('../nuxt.config.js')\n  config.dev = !(app.env === 'production')\n\n  // Instantiate nuxt.js\n  const nuxt = new Nuxt(config)\n\n  // Build in development\n  if (config.dev) {\n    const builder = new Builder(nuxt)\n    await builder.build()\n  }\n\n  app.use(async (ctx, next) => {\n    await next()\n    ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n    return new Promise((resolve, reject) => {\n      ctx.res.on('close', resolve)\n      ctx.res.on('finish', resolve)\n      nuxt.render(ctx.req, ctx.res, promise => {\n        // nuxt.render passes a rejected promise into callback on error.\n        promise.then(resolve).catch(reject)\n      })\n    })\n  })\n\n  // Listen mongo & koa\n  db.once('open', () => {\n    // app.listen(port, host)\n    // console.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n  })\n\n  // Start server\n  app.listen(port, host)\n  console.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n\n  // SSL options\n  // var options = {\n  //   key: fs.readFileSync(path.resolve(__dirname) + '/../.ssl/key.pem'),\n  //   cert: fs.readFileSync(path.resolve(__dirname) + '/../.ssl/cert.pem')\n  // }\n\n  // start the server\n  //http.createServer(app.callback()).listen(port)\n  //https.createServer(options, app.callback()).listen(443)\n\n  return { app, db }\n}\n\nconst server = start()\n\nexport default server\n\n\n// WEBPACK FOOTER //\n// ./server/index.js"],"sourceRoot":""}